{
  "Id": "DisableCortana",
  "Name": "Disable Cortana",
  "Description": "Disables Cortana voice assistant and removes it from the taskbar, improving privacy and system performance.",
  "Category": "Privacy",
  "Severity": "Low",
  "Tags": ["cortana", "voice", "assistant", "privacy", "taskbar"],
  "CTTKey": "",
  "ApplyOperations": {
    "RegistryOperations": [
      {
        "Hive": "LocalMachine",
        "KeyPath": "SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search",
        "ValueName": "AllowCortana",
        "Value": 0,
        "ValueType": "DWord",
        "Operation": "SetValue"
      },
      {
        "Hive": "LocalMachine",
        "KeyPath": "SOFTWARE\\Microsoft\\PolicyManager\\default\\Experience\\AllowCortana",
        "ValueName": "value",
        "Value": 0,
        "ValueType": "DWord",
        "Operation": "SetValue"
      },
      {
        "Hive": "CurrentUser",
        "KeyPath": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced",
        "ValueName": "ShowCortanaButton",
        "Value": 0,
        "ValueType": "DWord",
        "Operation": "SetValue"
      },
      {
        "Hive": "CurrentUser",
        "KeyPath": "SOFTWARE\\Microsoft\\Speech_OneCore\\Settings\\OnlineSpeechPrivacy",
        "ValueName": "HasAccepted",
        "Value": 0,
        "ValueType": "DWord",
        "Operation": "SetValue"
      }
    ],
    "ServiceOperations": [],
    "FileOperations": [],
    "PowerShellOperations": []
  },
  "UndoOperations": {
    "RegistryOperations": [
      {
        "Hive": "LocalMachine",
        "KeyPath": "SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search",
        "ValueName": "AllowCortana",
        "Value": 1,
        "ValueType": "DWord",
        "Operation": "SetValue"
      },
      {
        "Hive": "LocalMachine",
        "KeyPath": "SOFTWARE\\Microsoft\\PolicyManager\\default\\Experience\\AllowCortana",
        "ValueName": "value",
        "Value": 1,
        "ValueType": "DWord",
        "Operation": "SetValue"
      },
      {
        "Hive": "CurrentUser",
        "KeyPath": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced",
        "ValueName": "ShowCortanaButton",
        "Value": 1,
        "ValueType": "DWord",
        "Operation": "SetValue"
      },
      {
        "Hive": "CurrentUser",
        "KeyPath": "SOFTWARE\\Microsoft\\Speech_OneCore\\Settings\\OnlineSpeechPrivacy",
        "ValueName": "HasAccepted",
        "Value": 1,
        "ValueType": "DWord",
        "Operation": "SetValue"
      }
    ],
    "ServiceOperations": [],
    "FileOperations": [],
    "PowerShellOperations": []
  },
  "DetectionRules": [
    {
      "Type": "Registry",
      "Hive": "LocalMachine",
      "KeyPath": "SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search",
      "ValueName": "AllowCortana",
      "ExpectedValue": 0,
      "ValueType": "DWord"
    },
    {
      "Type": "Registry",
      "Hive": "LocalMachine",
      "KeyPath": "SOFTWARE\\Microsoft\\PolicyManager\\default\\Experience\\AllowCortana",
      "ValueName": "value",
      "ExpectedValue": 0,
      "ValueType": "DWord"
    },
    {
      "Type": "Registry",
      "Hive": "CurrentUser",
      "KeyPath": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced",
      "ValueName": "ShowCortanaButton",
      "ExpectedValue": 0,
      "ValueType": "DWord"
    },
    {
      "Type": "Registry",
      "Hive": "CurrentUser",
      "KeyPath": "SOFTWARE\\Microsoft\\Speech_OneCore\\Settings\\OnlineSpeechPrivacy",
      "ValueName": "HasAccepted",
      "ExpectedValue": 0,
      "ValueType": "DWord"
    }
  ],
  "Authors": [
    {
      "Name": "MyTekki",
      "Url": "https://mytekki.com",
      "SupportUrl": "https://mytekki.com",
      "Type": "Original",
      "Notes": "Custom implementation for Cortana voice assistant disable - completely disables Cortana and removes taskbar presence"
    }
  ]
}